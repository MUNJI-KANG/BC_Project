{% extends 'base.html' %}
{% load static %}
{% block css %}
<link rel="stylesheet" href="{% static 'css/findID.css' %}">
{% endblock %}
{% block title %}비밀번호 찾기 - 할래말래{% endblock %}

<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>회원가입 - 할래말래</title>
  {% load static %}
  <link rel="stylesheet" href="{% static 'css/common.css' %}" />
  <link rel="stylesheet" href="{% static 'css/responsive.css' %}" />
  <link rel="stylesheet" href="{% static 'css/findPW.css' %}" />

{% block contents %}

<div class="findID-container">
    <div class="findID-wrapper">

        <!-- PC 브랜딩 -->
        <div class="findID-brand">
            <h2>할래말래</h2>
            <p>스포츠 시설을 쉽고 빠르게 예약하세요</p>
            <ul class="findID-brand-features">
                <li>간편한 온라인 예약</li>
                <li>다양한 스포츠 시설</li>
                <li>실시간 예약 현황</li>
                <li>안전한 결제 시스템</li>
            </ul>
        </div>

        <!-- PW 찾기 카드 -->
        <div class="findID-card">

            <div class="findID-header">
                <h1>비밀번호 찾기</h1>
                <p>등록된 정보로 본인확인을 진행합니다</p>
            </div>

            <form class="findID-form" method="post">
                {% csrf_token %}

                <!-- 아이디 -->
                <div class="form-group">
                    <label class="form-label">아이디</label>
                    <input type="text" name="user_id" class="form-input" placeholder="아이디 입력" required>
                </div>

                <!-- 이름 -->
                <div class="form-group">
                    <label class="form-label">이름</label>
                    <input type="text" name="name" class="form-input" placeholder="이름 입력" required>
                </div>

                <!-- 생년월일 -->
                <div class="form-group">
                    <label class="form-label">생년월일</label>
                    <input type="text" name="birthday" class="form-input" placeholder="ex) 20020528" required>
                </div>

                <!-- 전화번호 -->
                <div class="form-group">
                    <label class="form-label">전화번호</label>
                    <div class="form-row phone-row">
                        <input type="text" name="phone1" class="form-input phone1" maxlength="3" value="010" required>
                        <span class="phone-dash">-</span>
                        <input type="text" name="phone2" class="form-input phone2" maxlength="4" placeholder="0000" required>
                        <span class="phone-dash">-</span>
                        <input type="text" name="phone3" class="form-input phone3" maxlength="4" placeholder="0000" required>
                    </div>
                </div>

                <button type="submit" class="findID-btn">비밀번호 찾기</button>
            </form>

            <div class="findID-links">
                <a href="/findID" class="form-link">ID 찾기</a>
                <span class="form-link-divider"></span>
                <a href="/login" class="form-link">로그인</a>
                <span class="form-link-divider"></span>
                <a href="/signup" class="form-link">회원가입</a>
            </div>

        </div>
    </div>
</div>

<div id="findPW-data" 
     {% if error %}data-error="{{ error|escapejs }}"{% endif %}
     {% if result_pw %}data-result-pw="{{ result_pw|escapejs }}"{% endif %}
     style="display: none;"></div>

{% endblock %}

{% block script1 %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    var dataEl = document.getElementById('findPW-data');
    if (!dataEl) return;
    
    var errorMsg = dataEl.getAttribute('data-error');
    if (errorMsg) {
        alert(errorMsg);
    }
    
    var newPassword = dataEl.getAttribute('data-result-pw');
    if (newPassword) {
        alert("새로운 비밀번호는 '" + newPassword + "' 입니다.\n로그인후 마이페이지에서 비밀번호를 변경해주세요.");
        window.location.href = "/login";
    }
});
</script>
{% endblock %}
